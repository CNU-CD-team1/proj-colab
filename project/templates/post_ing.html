<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AIDrawing Post</title>

  <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
  <!-- ##### CSS ##### -->
  <link rel="stylesheet" href="../static/css/bootstrap.css">
  <link rel="stylesheet" href="../static/css/style.css">
  <!-- Favicon -->
  <link rel="shortcut icon" href="../static/images/favicon.png" type="image/x-icon">
  <!-- Font Awesome icons (free version)-->
  <script src="https://use.fontawesome.com/releases/v6.3.0/js/all.js" crossorigin="anonymous"></script>
  <!-- Google fonts-->
  <link href="https://fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet" type="text/css" />
  <link href="https://fonts.googleapis.com/css?family=Roboto+Slab:400,100,300,700" rel="stylesheet" type="text/css" />

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/all.min.css">

  <!-- ##### bootstrap icon ##### -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.1/font/bootstrap-icons.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
</head>

<style>
  .wrapper {
    display: flex;
    max-width: 1200px;
    position: relative;
  }

  .wrapper i {
    top: 50%;
    height: 44px;
    width: 44px;
    color: #343F4F;
    cursor: pointer;
    font-size: 1.15rem;
    position: absolute;
    text-align: center;
    line-height: 44px;
    background: #fff;
    border-radius: 50%;
    transform: translateY(-50%);
    transition: transform 0.1s linear;
  }

  .wrapper i:active {
    transform: translateY(-50%) scale(0.9);
  }

  .wrapper i:hover {
    background: #f2f2f2;
  }

  .wrapper i:first-child {
    left: -22px;
    display: none;
  }

  .wrapper i:last-child {
    right: -22px;
  }

  .wrapper .carousel {
    font-size: 0px;
    cursor: pointer;
    overflow: hidden;
    white-space: nowrap;
    scroll-behavior: smooth;
  }

  .carousel.dragging {
    cursor: grab;
    scroll-behavior: auto;
  }

  .carousel.dragging img {
    pointer-events: none;
  }

  .carousel img {
    height: 340px;
    object-fit: cover;
    user-select: none;
    margin-left: 14px;
    width: calc(100% / 3);
  }

  .carousel img:first-child {
    margin-left: 0px;
  }

  @media screen and (max-width: 900px) {
    .carousel img {
      width: calc(100% / 2);
    }
  }

  @media screen and (max-width: 550px) {
    .carousel img {
      width: 100%;
    }
  }

  .center-line {
    display: flex;
    justify-content: center;
    align-items: center;
  }

  /* #### 갤러리바 #####*/
  .gallery {
    width: 90%;
    text-align: center;
    display: flex;

  }

  .onoff-button {
    width: 133px;
    background-image: url("../static/images/ing_post.png");
    background-size: cover;
  }

  @font-face {
    font-family: 'SUITE-Regular';
    src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_2304-2@1.0/SUITE-Regular.woff2') format('woff2');
    font-weight: 400;
    font-style: normal;
  }

  /* 제목 텍스트 설정 */
  .title {
    font-family: 'SUITE-Regular';
    font-weight: 800;
    font-size: 150%;
  }

  /* 경쟁작 부분 */
  .competitionPart {
    width: 82%;
  }

  .competitionImg {
    width: 190px;
    border: 2px solid #FFE4B5;
    border-radius: 5px;
    margin-top: 5px;
    margin-left: 5px;
    margin-right: 5px;
  }


  /* 갤러리 돌아가기 아이콘 */
  #square {
    width: 18px;
    height: 18px;
    background-color: #B3B3B3;
    margin: 1px;
  }

  #galleryIcon:hover>div>div {
    background-color: #8DD5CB;
    -webkit-transition: 0.5s;
    transition: 0.5s;
  }

  /*경쟁작 좋아요 부분*/
  .postName {
    padding-left: 5px;
    margin: 10px 0px;
  }

  .bi-heart {
    font-size: 20px;
    line-height: 20px;
    color: crimson;
  }

  .bi-heart-fill {
    font-size: 20px;
    line-height: 20px;
    color: crimson;
  }

  .bi-heart:hover {
    font-size: 20px;
    line-height: 20px;
    color: rgb(233, 131, 131);
  }

  .bi-heart-fill:hover {
    font-size: 20px;
    line-height: 20px;
    color: rgb(233, 131, 131);
  }

  .card-text {
    width: 100%;
    height: 40px;
    /*border: 1px solid green;*/
    padding-top: 3px;
    padding-left: 10px;
    font-size: 10px;
    text-align: initial;
  }

  .competitionCut {
    border: 1px solid #D9D9D9;
    border-radius: 8px;
    text-align: center;
    width: 230px;
    margin: 3px;

  }

  .heart-icon {
    /*border: 1px solid yellow;*/
    width: 100%;
    height: 40px;
    text-align: left;
    padding-left: 10px;
  }

  /* 이미지 프롬프트 설정 스타일 */
  @font-face {
    font-family: 'SUITE-Regular';
    src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_2304-2@1.0/SUITE-Regular.woff2') format('woff2');
    font-weight: 400;
    font-style: normal;
  }

  .prev_cut_explain {
    font-family: 'SUITE-Regular';
    font-size: 15px;
  }

  .imageText {
    width: 100%;
    height: 100%;
    background-color: #dfedff;
    text-align: center;
    align-items: center;
    user-select: text;
    border: 1px solid #e0e0e0;
    padding: 0px;
    margin: 0px;
    color: #3e3e3e;
    font-size: 14px;
    font-family: 'SUITE-Regular';
    position: absolute;
    top: 0;
    left: 0;
    margin: 0;
    align-items: center;
    display: inline-block;
    z-index: 1;
    opacity: 0;
    visibility: hidden;
    transition: opacity 0.3s ease;
}

  .img {
    position: relative;
    width: 100%;
    display: inline-block;
  }

  .img img {
    width: 100%;
    height: auto;
    border: 2px solid #FFE4B5;
    border-radius: 5px;
  }


  .imgExplain {
    border-radius: 5px;
    border: 2px solid #FFE4B5;
    background-color: rgb(247, 247, 247);
    padding: 5px;
    font-family: 'SUITE-Regular';
    text-align: initial;
    overflow: hidden;
    /* 텍스트가 넘치는 부분을 감추기 위해 오버플로우를 숨김 처리합니다 */
    text-overflow: ellipsis;
    /* 텍스트가 넘칠 경우 말줄임표(...)를 표시합니다 */
    white-space: normal;
    /* 텍스트 줄 바꿈을 위해 줄 바꿈 문자를 유지하고 공백을 보존합니다 */
  }

</style>

<body>

  <!-- ##### Navbar Start #####  -->
  <nav class="navbar navbar-expand-lg navbar-dark fixed-top" id="mainNav">
    <div class="container">
      <a class="navbar-brand" href="/"><img src="../static/images/logo.png" alt="..." /></a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarResponsive"
        aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
        Menu
        <i class="fas fa-bars ms-1"></i>
      </button>
      <div class="collapse navbar-collapse" id="navbarResponsive">
        <ul class="navbar-nav text-uppercase ms-auto py-4 py-lg-0">
          <li class="nav-item"><img src="../static/images/list.png" class="ul-li-icon">
            <a class="nav-link" href="drawing">Drawing</a>
          </li>
          <li class="nav-item"><img src="../static/images/list.png" class="ul-li-icon">
            <a class="nav-link" href="gallery_ing">Gallery</a>
          </li>
          <li class="nav-item"><img src="../static/images/list.png" class="ul-li-icon">
            <a class="nav-link" href="#">MyPage</a>
          </li>
          <li class="nav-item"><img src="../static/images/list.png" class="ul-li-icon">
            <a class="nav-link" href="#">Manual</a>
          </li>
        </ul>
      </div>
    </div>
  </nav>
  <!-- ##### Navbar End #####  -->

  <!-- ##### Gallerbar Start ##### -->
  <div class="gallery-bar container">
    <div class="row align-items-end">
      <div class="col-4">
        <!-- 첫 번째 등분 -->
      </div>
      <!-- ##### 완결작/진행작 버튼 #####-->
      <div class="col-4 center-line">
        <div class="onoff-button">
          <h6
            style="color:#7E7E7E; font-weight:bolder; font-size:larger; padding-top: 16px; padding-left: 15px; float:left;">
            진행작</h6>
          <a class="circlebutton" href="/gallery_end" style="padding:8px; float:right;"><img
              src="../static/images/circle_button2.png" height="40px" /></a>
        </div>
      </div>

      <div class="col-4">
        <!-- 세 번째 등분 -->
      </div>
    </div>
  </div>
  <!-- #### 수평선 #### -->
  <div style="width:100%; display:flex; justify-content:center;">
    <hr style="width:70%">
  </div>
  <!-- ##### Gallerbar End ##### -->

  <!-- #### 제목 ##### -->
  <div class="center-line">
    <div style="width:70%;">
      <div class="title">
        {{ id }} 제목 : {{ title }}
      </div>
    </div>
  </div>
  <!-- 제목 끝 -->

  <br>
  <p class="center-line prev_cut_explain" style="margin-bottom:0px;"> 마우스를 올려서 컷을 생성한 텍스트를 참고해보세요 ! </p>
  <div class="container center-line" style="width:75%;">
    <div class="row justify-content-between">
      {% for i in range(images|length) %}
      <!-- 컷 이미지 및 컷 설명창 & 다음그림 그리기-->
      <div class="col-md d-flex center-line" style="margin: 0px; padding: 0px;">
        <div style="width:85%; text-align:center;">
          <div class="img" style="width:100%;">
            <div>
              <img src="data:image/png;base64,{{ images[i]|b64encode }}" style="width: 100%; height: auto;"
                onclick="dis()" onmouseover="showText(this)" onmouseout="hideText(this)">
              <div class="imageText" draggable="true" onmouseover="showText(this)" onmouseout="hideText(this)"> {{ prompts[i] }}</div>
            </div>
          </div>
          <!-- 컷 설명  -->
          <div class="imgExplain" style="width: 100%; height:150px; margin-top:5px;">
            {{ scripts[i] }}
            <!-- prompts[i]값은 hover했을때 보여주고/ 설명창은 cut내용(cut_script) 들어가야함 -->
          </div>
          <!-- 컷 -->
        </div>
      </div>
      {% endfor %}

      {% if images|length < 3 %} {% for i in range(3 - images|length) %} <div class="col-md d-flex center-line"
        style="margin: 0px; padding: 0px;">
        <div class="img" style="width:85%; text-align:center;">
          <!-- 컷 -->
          <img src="../static/images/default.png" style="width: 100%;" onclick="dis()">
          <!-- 컷 설명  -->
          <div class="imgExplain" style="width: 100%; height:150px; margin-top:5px;">
            다음 컷을 그리고 싶다면 우측의 <b><i>+ 버튼</i></b>을 눌러주세요!
          </div>
        </div>
    </div>
    {% endfor %}
    {% endif %}
    <!-- ##### 네번째 컷은 픽스가 안됨 따라서, 이미지 클릭했을 때 경쟁작컷을 보여줄 수 있다는 문구, 
        이미지 hover했을때 프롬프트값 보여줄 수 있다는 문구 넣으면 어떨까요..? -->
    <div class="col-md d-flex center-line" style="margin: 0px; padding: 0px;">
      <div class="img" style="width:85%; text-align:center;">
        <!-- 컷 -->
        <img src="../static/images/default.png" style="width: 100%;" onclick="dis()">
        <!-- 컷 설명  -->
        <div class="imgExplain" style="width: 100%; height:150px; margin-top:5px;">
          탈락컷 또는 현재 진행중인 경쟁컷들을 보고싶다면 해당 컷의 이미지를 눌러주세요!
        </div>
      </div>
    </div>

    <div class="col-md d-flex center-line" style="margin: 0px; padding: 0px;">
      <div class="img" style="width:85%; text-align:center;">
        <!-- ########## Next Drawing ########## -->
        <form action="/next_drawing" method="post">
          <button type="submit" onclick="location.href='next_drawing';"
            style="border:none; width:100%; height:auto; padding:0px;">
            <img src="../static/images/plus.png" style="width:100%; height:auto; padding:0px;">
          </button>
          <input type="hidden" name="selected_post" value="{{ id }}">
        </form>
        <!-- 버튼 설명  -->
        <div class="imgExplain" style="width: 100%; height:150px; margin-top:5px;">
          이어갈 그림을 그리고 싶다면 위의 '+' 버튼을 눌러주세요.
        </div>
      </div>
    </div>
  </div>
  </div>
  <script>
    function showText(element) {
        var showelement = element.parentNode.querySelector(".imageText");
        if (showelement) {
            showelement.style.visibility = "visible";
            showelement.style.opacity = "1";
            
        }
    }

    function hideText(element) {
        var showelement = element.parentNode.querySelector(".imageText");
        if (showelement) {
            showelement.style.opacity = "0";
            showelement.style.visibility = "hidden";
            
            
        }
    }
</script>

  <br>

  <!-- 이미지 클릭시 경쟁작 show/hide -->
  <!-- 클릭한 컷의 id에 따라 경쟁작 보여주기.. -->
  <script>
    function dis() {
      if ($('.competitionPart').css('display') == 'none') {
        $('.competitionPart').show();
      } else {
        $('.competitionPart').hide();
      }
    }
  </script>

  <!-- ###### 경쟁작 시작 부분 ###### -->
  <div class="container center-line competitionPart" display='none'>
    <div class="row">
      <div class="col-3 competitionCut">
        <a href="#postid" style="text-decoration: none; color:black;">
          <img class="card-img-top competitionImg" src="../static/images/default.png" alt="Image">
          <div class="card-text">
            <p class="postName"> title </p>
          </div>
        </a>
        <div class="heart-icon">
          <i class="bi bi-heart"></i>
          <i class="result"> votes </i>
        </div>

      </div>

      <div class="col-3 competitionCut">
        <a href="#postid" style="text-decoration: none; color:black;">
          <img class="card-img-top competitionImg" src="../static/images/default.png" alt="Image">
          <div class="card-text">
            <p class="postName"> title </p>
          </div>
        </a>
        <div class="heart-icon">
          <i class="bi bi-heart"></i>
          <i class="result"> votes </i>
        </div>


      </div>

      <div class="col-3 competitionCut">
        <a href="#postid" style="text-decoration: none; color:black;">
          <img class="card-img-top competitionImg" src="../static/images/default.png" alt="Image">
          <div class="card-text">
            <p class="postName"> title </p>
          </div>
        </a>
        <div class="heart-icon">
          <i class="bi bi-heart"></i>
          <i class="result"> votes </i>
        </div>


      </div>

      <div class="col-3 competitionCut">
        <a href="#postid" style="text-decoration: none; color:black;">
          <img class="card-img-top competitionImg" src="../static/images/default.png" alt="Image">
          <div class="card-text">
            <p class="postName"> title </p>
          </div>
        </a>
        <div class="heart-icon">
          <i class="bi bi-heart"></i>
          <i class="result"> votes </i>
        </div>


      </div>

      <div class="col-3 competitionCut">
        <a href="#postid" style="text-decoration: none; color:black;">
          <img class="card-img-top competitionImg" src="../static/images/default.png" alt="Image">
          <div class="card-text">
            <p class="postName"> title </p>
          </div>
        </a>
        <div class="heart-icon">
          <i class="bi bi-heart"></i>
          <i class="result"> votes </i>
        </div>

        <!-- ##### 하트 아이콘 ##### -->

        <script>
          var i = 0;
          $('.bi-heart').on('click', function () {
            // 결과를 표시할 element
            const resultElement = document.getElementsByClassName('result');
            // 현재 화면에 표시된 값
            let number = resultElement.innerText;
            if (i == 0) {
              $(this).removeClass('bi-heart');
              $(this).addClass('bi-heart-fill');
              number = parseInt(number) + 1;
              i++;
            } else if (i == 1) {
              $(this).removeClass('bi-heart-fill');
              $(this).addClass('bi-heart');
              number = parseInt(number) - 1;
              i--;
            }
            resultElement.innerText = number;
          });
        </script>


      </div>

    </div>
  </div>
  <!-- ###### 경쟁작 끝난 부분 ###### -->


  <br>
  <br>

  <!-- 갤러리로 돌아가기 아이콘 -->
  <a id="galleryIcon" href="gallery_ing">
    <div class="center-line">
      <div id="square"> </div>
      <div id="square"> </div>

    </div>
    <div class="center-line">
      <div id="square"> </div>
      <div id="square"> </div>

    </div>
  </a>
  <br>

  <!-- ##### JS ##### -->
  <script src="../static/js/bootstrap.js"></script>
  <script src="../static/js/main.js"></script>
</body>

</html>